<div class="dropfile" (fileDrop)="parseCSVFiles($event)">
  <div class="titlebar">
    <h1>{{ institution.name || 'New' }} Institution</h1>
    <mat-icon (click)="cancelForm.emit()" fontIcon="cancel" class="big cancel-icon"></mat-icon>
  </div>
  <form (ngSubmit)="saveChanges()">
    <div class="column wide">
      <label for="name">Name: </label>
      <input type="text" id="name" name="name" tabindex="1" [(ngModel)]="institution.name" required maxlength="64" />
      <label for="description">Description: </label>
      <input type="text" id="description" name="description" tabindex="2" [(ngModel)]="institution.description" required maxlength="255" />
      <div class="row wide">
        <label for="addMapping">Mapping ( {{ institution.mappings.length }} ): </label>
        <mat-icon id="addMapping" name="addMapping" tabindex="3" (click)="addMapping()" fontIcon="add" class="add-icon"></mat-icon>
      </div>
    </div>
    <ul>
@for(mapping of institution.mappings; track institution.mappings[index]; let index = $index) {
      <li>
        <yaba-institution-mapping
          [index]="index"
          [(mapping)]="institution.mappings[index]"
          [(fields)]="fields"
          (fieldsChange)="getTransactionFields()"
          (removeMapping)="removeMapping(index)"
          class="suave"
          ></yaba-institution-mapping>
      </li>
}
    </ul>
    <errors [errors]="errors"></errors>
    <div class="submission">
      <input type="button"
        tabindex="{{ 3 + ((institution.mappings.length || 0)*4) +1 }}"
        name="cancelBtn"
        value="Cancel" (click)="doCancelForm()"
        class="cancel" />
      <input type="button"
        name="saveBtn"
        tabindex="{{ 3 + ((institution.mappings.length || 0)*4) +2 }}"
        value="Save Institution"
        (click)="saveChanges()"
        class="save" />
    </div>
  </form>
</div>
